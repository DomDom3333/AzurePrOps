<Window
    Background="{DynamicResource BackgroundBrush}"
    Icon="/Assets/avalonia-logo.ico"
    Title="AzurePrOps"
    d:DesignHeight="600"
    d:DesignWidth="1000"
    mc:Ignorable="d"
    x:Class="AzurePrOps.Views.MainWindow"
    x:DataType="vm:MainWindowViewModel"
    xmlns="https://github.com/avaloniaui"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ff="using:AzurePrOps.Models"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:model="using:AzurePrOps.AzureConnection.Models"
    xmlns:vm="using:AzurePrOps.ViewModels"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <Border
            Background="{DynamicResource SurfaceBrush}"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="0,0,0,1"
            Padding="24,20">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock
                    FontSize="24"
                    FontWeight="Bold"
                    Text="Pull Requests" />
                <StackPanel
                    Grid.Column="1"
                    Orientation="Horizontal"
                    Spacing="12">
                    <Button
                        Classes="PrimaryButton"
                        Command="{Binding RefreshCommand}"
                        Content="Refresh" />
                    <Button
                        Classes="SecondaryButton"
                        Command="{Binding OpenSettingsCommand}"
                        Content="Settings" />
                </StackPanel>
            </Grid>
        </Border>

        <!--  Main Content  -->
        <Grid
            ColumnDefinitions="300,*"
            Grid.Row="1"
            Margin="24,20">
            <!--  Sidebar  -->
            <ScrollViewer
                Grid.Column="0"
                Margin="0,0,16,0"
                VerticalScrollBarVisibility="Auto">
                <StackPanel Spacing="16">
                    <!--  Enhanced Filters  -->
                    <Border Classes="Card">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock
                                    FontSize="16"
                                    FontWeight="SemiBold"
                                    Text="Filters" />
                                <Button
                                    Classes="SecondaryButton"
                                    Command="{Binding ResetFiltersCommand}"
                                    Content="Reset" />
                            </StackPanel>

                            <!--  Workflow Presets  -->
                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Workflow Preset" />
                                <ComboBox
                                    ItemsSource="{Binding WorkflowPresets}"
                                    SelectedItem="{Binding SelectedWorkflowPreset}"
                                    ToolTip.Tip="{Binding SelectedWorkflowPresetTooltip}" />
                            </StackPanel>

                            <!--  Text Filters  -->
                            <StackPanel Spacing="8">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Text Filters" />
                                <TextBox Text="{Binding FilterCriteria.TitleFilter}" Watermark="Title contains..." />
                                <AutoCompleteBox
                                    ItemsSource="{Binding AvailableCreators}"
                                    Text="{Binding FilterCriteria.CreatorFilter}"
                                    Watermark="Creator" />
                                <AutoCompleteBox
                                    ItemsSource="{Binding AvailableReviewers}"
                                    Text="{Binding FilterCriteria.ReviewerFilter}"
                                    Watermark="Reviewer" />
                                <AutoCompleteBox
                                    ItemsSource="{Binding AvailableSourceBranches}"
                                    Text="{Binding FilterCriteria.SourceBranchFilter}"
                                    Watermark="Source Branch" />
                                <AutoCompleteBox
                                    ItemsSource="{Binding AvailableTargetBranches}"
                                    Text="{Binding FilterCriteria.TargetBranchFilter}"
                                    Watermark="Target Branch" />
                            </StackPanel>

                            <!--  Status Filter  -->
                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Status Filter" />
                                <ComboBox ItemsSource="{Binding AvailableStatuses}" SelectedItem="{Binding StatusFilter}" />
                            </StackPanel>

                            <!--  Date Range Filters  -->
                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Date Range" />
                                <DatePicker SelectedDate="{Binding FilterCriteria.CreatedAfter}" />
                                <DatePicker SelectedDate="{Binding FilterCriteria.CreatedBefore}" />
                            </StackPanel>

                            <!--  Quick Filters  -->
                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Quick Filters" />
                                <CheckBox Content="My Pull Requests Only" IsChecked="{Binding FilterCriteria.MyPullRequestsOnly}" />
                                <CheckBox Content="Assigned to Me Only" IsChecked="{Binding FilterCriteria.AssignedToMeOnly}" />
                                <CheckBox Content="Needs My Review Only" IsChecked="{Binding FilterCriteria.NeedsMyReviewOnly}" />
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Drafts:" VerticalAlignment="Center" />
                                    <ComboBox>
                                        <ComboBoxItem Content="All" />
                                        <ComboBoxItem Content="Drafts Only" />
                                        <ComboBoxItem Content="Non-Drafts Only" />
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>

                            <!--  Group Filtering  -->
                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Group Filtering" />
                                <CheckBox
                                    Content="Enable Group Filtering"
                                    IsChecked="{Binding EnableGroupFiltering}"
                                    ToolTip.Tip="Filter PRs to only show those where selected groups are reviewers" />
                                <StackPanel IsVisible="{Binding EnableGroupFiltering}" Spacing="4">
                                    <TextBlock
                                        FontSize="10"
                                        Foreground="{StaticResource TextSecondaryBrush}"
                                        Text="{Binding SelectedGroupsText}"
                                        TextWrapping="Wrap" />
                                    <StackPanel Orientation="Horizontal" Spacing="4">
                                        <Button
                                            Classes="SecondaryButton"
                                            Command="{Binding SelectGroupsCommand}"
                                            Content="Select Groups"
                                            FontSize="10"
                                            Padding="6,2" />
                                        <Button
                                            Classes="SecondaryButton"
                                            Command="{Binding ClearGroupSelectionCommand}"
                                            Content="Clear"
                                            FontSize="10"
                                            Padding="6,2" />
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>

                            <!--  Groups Without Vote Filtering  -->
                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Groups Without Vote" />
                                <CheckBox
                                    Content="Show PRs with Groups Pending Vote"
                                    IsChecked="{Binding EnableGroupsWithoutVoteFilter}"
                                    ToolTip.Tip="Filter PRs to only show those where selected groups are reviewers but haven't voted yet" />
                                <StackPanel IsVisible="{Binding EnableGroupsWithoutVoteFilter}" Spacing="4">
                                    <TextBlock
                                        FontSize="10"
                                        Foreground="{StaticResource TextSecondaryBrush}"
                                        Text="{Binding SelectedGroupsWithoutVoteText}"
                                        TextWrapping="Wrap" />
                                    <StackPanel Orientation="Horizontal" Spacing="4">
                                        <Button
                                            Classes="SecondaryButton"
                                            Command="{Binding SelectGroupsWithoutVoteCommand}"
                                            Content="Select Groups"
                                            FontSize="10"
                                            Padding="6,2" />
                                        <Button
                                            Classes="SecondaryButton"
                                            Command="{Binding ClearGroupsWithoutVoteSelectionCommand}"
                                            Content="Clear"
                                            FontSize="10"
                                            Padding="6,2" />
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!--  Sorting  -->
                    <Border Classes="Card">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock
                                    FontSize="16"
                                    FontWeight="SemiBold"
                                    Text="Sorting" />
                                <Button
                                    Classes="SecondaryButton"
                                    Command="{Binding ResetSortingCommand}"
                                    Content="Reset" />
                            </StackPanel>

                            <!--  Sort Presets  -->
                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Quick Sort" />
                                <ComboBox
                                    ItemsSource="{Binding SortPresets}"
                                    SelectedItem="{Binding SelectedSortPreset}"
                                    ToolTip.Tip="{Binding SelectedSortPresetTooltip}" />
                            </StackPanel>

                            <!--  Custom Sorting  -->
                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="Medium"
                                    Text="Primary Sort" />
                                <Grid ColumnDefinitions="*,Auto">
                                    <ComboBox
                                        Grid.Column="0"
                                        ItemsSource="{Binding SortFieldOptions}"
                                        SelectedItem="{Binding SortCriteria.PrimarySortField}" />
                                    <ToggleButton
                                        Content="↑↓"
                                        Grid.Column="1"
                                        Margin="4,0,0,0" />
                                </Grid>
                            </StackPanel>

                        </StackPanel>
                    </Border>

                    <!--  Saved Views  -->
                    <Border Classes="Card">
                        <StackPanel Spacing="12">
                            <TextBlock
                                FontSize="16"
                                FontWeight="SemiBold"
                                Text="Saved Views" />
                            <StackPanel Spacing="8">
                                <ComboBox ItemsSource="{Binding FilterViews}" SelectedItem="{Binding SelectedFilterView}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBox
                                        Text="{Binding NewViewName}"
                                        Watermark="View Name"
                                        Width="120" />
                                    <Button
                                        Classes="SecondaryButton"
                                        Command="{Binding SaveViewCommand}"
                                        Content="Save"
                                        Width="60" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!--  Quick Comment  -->
                    <Border Classes="Card" IsVisible="{Binding SelectedPullRequest, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <StackPanel Spacing="8">
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Text="💬 Quick Comment" />
                            <TextBox
                                AcceptsReturn="True"
                                MinHeight="60"
                                Text="{Binding NewCommentText}"
                                TextWrapping="Wrap"
                                Watermark="Add a comment to the selected PR..." />
                            <Button
                                Classes="PrimaryButton"
                                Command="{Binding PostCommentCommand}"
                                Content="📤 Post Comment"
                                HorizontalAlignment="Right" />
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>

            <!--  Pull Request List and Comments  -->
            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
                <StackPanel Spacing="16">
                    <!--  PR List  -->
                    <Border Classes="Card">
                        <StackPanel Spacing="12">
                            <TextBlock
                                FontSize="16"
                                FontWeight="SemiBold"
                                Text="Pull Requests" />
                            <ListBox
                                DoubleTapped="PullRequests_DoubleTapped"
                                ItemsSource="{Binding PullRequests}"
                                MinHeight="300"
                                SelectedItem="{Binding SelectedPullRequest}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate x:DataType="model:PullRequestInfo">
                                        <Border
                                            Background="{StaticResource SurfaceBrush}"
                                            BorderBrush="{StaticResource BorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="6"
                                            Margin="0,0,0,4"
                                            Padding="12">
                                            <Grid ColumnDefinitions="Auto,*,Auto">
                                                <!--  Status & Priority Column  -->
                                                <StackPanel
                                                    Grid.Column="0"
                                                    Margin="0,0,12,0"
                                                    Spacing="4"
                                                    VerticalAlignment="Center">
                                                    <Border
                                                        Background="{Binding Status, Converter={StaticResource StatusToBrush}}"
                                                        CornerRadius="12"
                                                        HorizontalAlignment="Center"
                                                        Padding="6,2"
                                                        ToolTip.Tip="{Binding Status, StringFormat='Status: {0}'}">
                                                        <TextBlock
                                                            FontSize="8"
                                                            FontWeight="Bold"
                                                            Foreground="White"
                                                            HorizontalAlignment="Center"
                                                            Text="{Binding Status}" />
                                                    </Border>
                                                    <TextBlock
                                                        FontSize="20"
                                                        HorizontalAlignment="Center"
                                                        IsVisible="{x:Static ff:FeatureFlagManager.LifecycleActionsEnabled}"
                                                        Text="{Binding ReviewerVoteIcon}"
                                                        ToolTip.Tip="{Binding ReviewerVote, StringFormat='My Review Status: {0}'}" />
                                                </StackPanel>

                                                <!--  Main Content Column  -->
                                                <StackPanel Grid.Column="1" Spacing="6">
                                                    <!--  Title & Draft Badge  -->
                                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                                        <TextBlock
                                                            FontSize="16"
                                                            FontWeight="SemiBold"
                                                            MaxWidth="450"
                                                            Text="{Binding Title}"
                                                            TextWrapping="Wrap"
                                                            ToolTip.Tip="{Binding Title}" />
                                                        <Border
                                                            Background="{DynamicResource ErrorBrush}"
                                                            CornerRadius="8"
                                                            IsVisible="{Binding ShowDraftBadge}"
                                                            Padding="4,1"
                                                            ToolTip.Tip="This is a draft pull request - not ready for final review">
                                                            <TextBlock
                                                                FontSize="9"
                                                                FontWeight="Bold"
                                                                Foreground="White"
                                                                Text="DRAFT" />
                                                        </Border>
                                                    </StackPanel>

                                                    <!--  Compact Metadata Row  -->
                                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                                        <TextBlock
                                                            FontSize="11"
                                                            FontWeight="Medium"
                                                            Foreground="{StaticResource TextSecondaryBrush}"
                                                            Text="{Binding Creator}"
                                                            ToolTip.Tip="{Binding Creator, StringFormat='Created by: {0}'}" />
                                                        <TextBlock
                                                            FontSize="11"
                                                            Foreground="{StaticResource TextSecondaryBrush}"
                                                            Text="{Binding Created, StringFormat='{}{0:MMM dd}'}"
                                                            ToolTip.Tip="{Binding Created, StringFormat='Created: {0:dddd, MMMM dd, yyyy at h:mm tt}'}" />
                                                        <TextBlock
                                                            FontSize="11"
                                                            Foreground="{StaticResource TextSecondaryBrush}"
                                                            Text="{Binding Reviewers.Count, StringFormat='{}{0} reviewers'}"
                                                            ToolTip.Tip="{Binding ReviewersText}" />
                                                        <StackPanel
                                                            IsVisible="{x:Static ff:FeatureFlagManager.LifecycleActionsEnabled}"
                                                            Orientation="Horizontal"
                                                            Spacing="4">
                                                            <TextBlock FontSize="11" Text="{Binding ReviewerVoteIcon}" />
                                                            <TextBlock
                                                                FontSize="11"
                                                                Foreground="{StaticResource TextSecondaryBrush}"
                                                                Text="{Binding ReviewerVote}" />
                                                        </StackPanel>
                                                    </StackPanel>

                                                    <!--  Branch Info (Compact)  -->
                                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                                        <TextBlock
                                                            FontFamily="Consolas"
                                                            FontSize="10"
                                                            Foreground="{StaticResource TextSecondaryBrush}"
                                                            Text="{Binding SourceBranch}"
                                                            ToolTip.Tip="{Binding SourceBranch, StringFormat='Source Branch: {0}'}" />
                                                        <TextBlock
                                                            FontSize="10"
                                                            Foreground="{StaticResource TextSecondaryBrush}"
                                                            Text="→"
                                                            ToolTip.Tip="Merge direction" />
                                                        <TextBlock
                                                            FontFamily="Consolas"
                                                            FontSize="10"
                                                            Foreground="{StaticResource TextSecondaryBrush}"
                                                            Text="{Binding TargetBranch}"
                                                            ToolTip.Tip="{Binding TargetBranch, StringFormat='Target Branch: {0}'}" />
                                                    </StackPanel>
                                                </StackPanel>

                                                <!--  Right Column - PR ID  -->
                                                <TextBlock
                                                    FontSize="11"
                                                    FontWeight="Medium"
                                                    Foreground="{StaticResource TextSecondaryBrush}"
                                                    Grid.Column="2"
                                                    Margin="12,0,0,0"
                                                    Text="{Binding Id, StringFormat='#{0}'}"
                                                    ToolTip.Tip="{Binding Id, StringFormat='Pull Request ID: {0}'}"
                                                    VerticalAlignment="Top" />
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                            <!--  Empty State Message  -->
                            <StackPanel
                                HorizontalAlignment="Center"
                                IsVisible="{Binding !PullRequests.Count}"
                                MinHeight="300"
                                Spacing="16"
                                VerticalAlignment="Center">
                                <TextBlock
                                    FontSize="48"
                                    HorizontalAlignment="Center"
                                    Opacity="0.3"
                                    Text="📝" />
                                <TextBlock
                                    FontSize="18"
                                    FontWeight="SemiBold"
                                    HorizontalAlignment="Center"
                                    Text="No Pull Requests Found" />
                                <TextBlock
                                    FontSize="14"
                                    Foreground="{StaticResource TextSecondaryBrush}"
                                    HorizontalAlignment="Center"
                                    MaxWidth="400"
                                    Text="There are currently no pull requests matching your filters. Try adjusting your filter criteria or refresh to load the latest pull requests."
                                    TextAlignment="Center"
                                    TextWrapping="Wrap" />
                                <Button
                                    Classes="PrimaryButton"
                                    Command="{Binding RefreshCommand}"
                                    Content="🔄 Refresh Pull Requests"
                                    HorizontalAlignment="Center" />
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!--  Quick Actions for Selected PR  -->
                    <Border Classes="Card" IsVisible="{Binding SelectedPullRequest, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <StackPanel Spacing="16">
                            <StackPanel
                                Orientation="Horizontal"
                                Spacing="8"
                                VerticalAlignment="Center">
                                <TextBlock
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Text="Quick Actions:" />
                                <TextBlock
                                    FontSize="12"
                                    Foreground="{StaticResource TextSecondaryBrush}"
                                    Text="{Binding SelectedPullRequest.Title}" />
                            </StackPanel>

                            <!--  Primary Review Actions  -->
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <Button
                                    Classes="SuccessButton"
                                    Command="{Binding ApproveCommand}"
                                    Content="✅ Approve" />
                                <Button
                                    Classes="SecondaryButton"
                                    Command="{Binding ApproveWithSuggestionsCommand}"
                                    Content="📝 Approve w/ Suggestions"
                                    IsVisible="{Binding LifecycleActionsEnabled}" />
                                <Button
                                    Classes="SecondaryButton"
                                    Command="{Binding WaitForAuthorCommand}"
                                    Content="⏳ Wait for Author"
                                    IsVisible="{Binding LifecycleActionsEnabled}" />
                                <Button
                                    Classes="DangerButton"
                                    Command="{Binding RejectCommand}"
                                    Content="❌ Reject"
                                    IsVisible="{Binding LifecycleActionsEnabled}" />
                            </StackPanel>

                            <!--  Secondary Actions  -->
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <Button
                                    Classes="SecondaryButton"
                                    Command="{Binding MarkDraftCommand}"
                                    Content="📝 Mark Draft"
                                    IsVisible="{Binding LifecycleActionsEnabled}" />
                                <Button
                                    Classes="SecondaryButton"
                                    Command="{Binding MarkReadyCommand}"
                                    Content="🚀 Mark Ready"
                                    IsVisible="{Binding LifecycleActionsEnabled}" />
                                <Button
                                    Classes="SecondaryButton"
                                    Command="{Binding CompleteCommand}"
                                    Content="✔️ Complete"
                                    IsVisible="{Binding LifecycleActionsEnabled}" />
                                <Button
                                    Classes="DangerButton"
                                    Command="{Binding AbandonCommand}"
                                    Content="🗑️ Abandon"
                                    IsVisible="{Binding LifecycleActionsEnabled}" />
                            </StackPanel>

                            <!--  Loading Progress  -->
                            <ProgressBar
                                Height="4"
                                IsIndeterminate="True"
                                IsVisible="{Binding IsLoadingDiffs}"
                                Margin="0,8,0,0" />
                        </StackPanel>
                    </Border>

                    <!--  PR Summary & Stats  -->
                    <Border Classes="Card" IsVisible="{Binding PullRequests.Count, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <StackPanel Spacing="12">
                            <TextBlock
                                FontSize="16"
                                FontWeight="SemiBold"
                                Text="📊 Summary" />
                            <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto">
                                <StackPanel Grid.Column="0" Spacing="4">
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="Bold"
                                        HorizontalAlignment="Center"
                                        Text="{Binding PullRequests.Count}" />
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{StaticResource TextSecondaryBrush}"
                                        HorizontalAlignment="Center"
                                        Text="Total PRs" />
                                </StackPanel>
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="Bold"
                                        HorizontalAlignment="Center"
                                        Text="{Binding ActivePRCount}" />
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{StaticResource TextSecondaryBrush}"
                                        HorizontalAlignment="Center"
                                        Text="Active" />
                                </StackPanel>
                                <StackPanel Grid.Column="2" Spacing="4">
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="Bold"
                                        HorizontalAlignment="Center"
                                        Text="{Binding MyReviewPendingCount}" />
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{StaticResource TextSecondaryBrush}"
                                        HorizontalAlignment="Center"
                                        Text="Need Review" />
                                </StackPanel>
                            </Grid>
                            <TextBlock
                                FontSize="12"
                                Foreground="{StaticResource TextSecondaryBrush}"
                                Text="💡 Tip: Use filters and presets in the sidebar to customize your workflow and focus on the most relevant pull requests."
                                TextWrapping="Wrap" />
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!--  Loading overlay while opening PR details  -->
        <Border
            Background="{DynamicResource OverlayBackgroundBrush}"
            IsHitTestVisible="{Binding IsLoadingDiffs}"
            IsVisible="{Binding IsLoadingDiffs}"
            ZIndex="100">
            <ProgressBar
                Background="{DynamicResource SurfaceBrush}"
                Foreground="{DynamicResource PrimaryBrush}"
                Height="20"
                HorizontalAlignment="Center"
                IsIndeterminate="True"
                VerticalAlignment="Center"
                Width="160" />
        </Border>
    </Grid>
</Window>
